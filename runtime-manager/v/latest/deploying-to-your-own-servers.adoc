= Deploying to Your Own Servers
:keywords: cloudhub, cloud, deploy, manage, runtime manager, arm

You can deploy a Mule application to your own server through:

// * *Anypoint Studio* - Right-click your project and click *Deploy to Anypoint Platform* -> *Cloud*.


* *Anypoint Platform, link:anypoint.mulesoft.com[cloud-based] version* - Go to the *Runtime Manager* section, and then from the *Applications* tab, click the *Deploy application* button.
* *Anypoint Platform, On-Premise Edition* - Go to the *Runtime Manager* section, and then from the *Applications* tab, click the *Deploy application* button.
* *Runtime Manager, On-Premise Edition* - From the *Applications* tab, click the *Deploy application* button.

This page describes the options on the *Deploy Application* page, which is identical in all of the cases above.

[TIP]
====
Additionally, you can also deploy to your servers through:

* The *link:/runtime-manager/runtme-manager-api[Runtime Manager API]*
* Using the *link:/mule-user-guide/v/3.2/mule-maven-plugin[Mule-Maven Plugin]*
====


[NOTE]
To deploy an app to link:/runtime-manager/cloudhub-and-runtime-manager[CloudHub], see link:/runtime-manager/deploying-to-cloudhub[Deploying to CloduHub]. Deploying to CloudHub is not possible via the link:/anypoint-platform-on-premises/[Anypoint Platfrom On Premises Edition] or the link:/anypoint-platform-on-premises/[Runtime Manager On Premises Edition].

== Accessing the Deploy Application Screen

=== From Anypoint Platform

To deploy an application:

. For the cloud-based version, log into link:https://anypoint.mulesoft.com[Anypoint Platform] or click *Sign up* on the sign on page. Otherwise, open the application on your local server and log in.
. Click *Runtime Manager*:
+
image:APStartScreen.png[APStartScreen]
+
. Click *Deploy application*:
+
image:DeployAppFromConsole.png[DeployAppFromConsole] 
+
[TIP]
*Note*: For more information on the *Servers* tab, see link:/runtime-manager/managing-servers[Managing Servers].
+
.  The Deploy Application page opens:
+
image:DeployAppFirstScreen.png[DeployAppFirstScreen] 

=== From Anypoint Studio

. With your application open in Anpoint Studio as a Mule Project, Right-click on the project node in the package explorer. Then select *Deploy to Anypoint Platform* > *Cloud* from the cascading menu.
+
image:deploy+to+cloudhub.png[deploy+to+cloudhub]
+
. If this is your first time deploying in this way, a popup menu asks you to provide your login credentials for the Anypoint Platform. Studio stores your credentials and uses them automatically the next time you deploy to CloudHub.

+
[TIP]
You can manage these credentials through the Studio *Preferences* menu, in *Anypoint Studio* > *Authentication*.

. After you sign in, the Deploy Application menu opens.
+
image:DeployAppFirstScreen.png[DeployAppFirstScreen] 

[TIP]
For an example of deploying to CloudHub directly from Anypoint Studio, see link:/runtime-manager/hello-world-on-cloudhub[Hello World on CloudHub].

== Creating an Application Name

Every application requires a unique application domain name. The application domain identifies your application in the Runtime Manager and also provides you with a public URL, `http://myapplicationdomain.cloudhub.io`, for accessing the application if it exposes any inbound endpoints.

In the *Deploy Application* dialog, enter a unique application name. The Application Name also becomes the `cloudhub.io` domain name that you use to access your application; for example the Application Name, `abcde` is accessible at `http://abcde.cloudhub.io`. Valid names contain alphanumeric characters and dashes, and contain at most 40 characters. If the name is valid, the Runtime Manager alerts you whether it is available or already reserved by another user.

image:DeployAppName.png[DeployAppName]

== Deployment Target

If you already have any servers registered to the Anypoint Platform, you will see a Deployment Target field that lets you specify where you want to deploy your application:

* On the CloudHub worker cloud
* On a server on premises, in a different cloud repo, a server group, or a cluster

This document focuses on deploying to CloudHub, for more information on deploying to servers, see

For more information on deploying to a server or server group, see








== Application File

Upload a new file for deployment. Click the *Choose file* button, select your application file, and then click *Open*. You can also click the *Get from sandbox* button to copy a file from a non-production environment into your current environment. (If the Get From Sandbox button does not appear, you may first need to create a non-production environment to view this option.) 

*Note*: The application file size limit is 100 MB.

image:ApplicationFile.png[ApplicationFile]


=== Runtime Version

Using the drop-down menu, select the *Runtime version* to which you to deploy:

image:RuntimeVersion2.png[RuntimeVersion2]

[IMPORTANT]
====
* Ensure that the runtime version is the same Mule version used to develop your application. For example, if you use the default value prod-3.5.0 and your application uses the new HTTP connector introduced in Mule 3.6 and newer, your application won't deploy and the log contains errors.
* To see what runtime version you set when you deployed your application, click the *Applications* tab and click your application. In the expansion view on the right, click *Manage Application*. Click *Settings* to see the deployment values.
====


=== Persistent Queues

Check this box to enable persistent queues on your application. Persistent queues protect against message loss and allow you to distribute workloads across a set of workers. Before you can take advantage of persistent queueing, your application needs to be set up to use queues. See link:/runtime-manager/cloudhub-fabric[CloudHub Fabric] for more information.

[IMPORTANT]
If your mule application is using link:/mule-user-guide/v/3.7/batch-processing[Batch] component and persistent queues, then you might see batch record being processed multiple times. All batch records are stored in Amazon SQS and by default the visibility of the message is set to 70 seconds. If your batch process takes longer than 70 seconds, then batch process might see same message again and process it multiple times.  To avoid this issue please set 'persistent.queue.min.timeout' system parameter to a reasonable value, for example if your batch process takes 30 minutes to complete then set value to 'persistent.queue.min.timeout=2700000' milliseconds ( 45 Minutes). Maximum value of 43000000 milliseconds (12 hours) is supported. See screen shot below for setting the value in cloudhub
image:MuleBatchWithPersistentQueueDuplicationSolution.png[MuleBatchWithPersistentQueues]

=== Automatic Restart

If you are deploying to a runtime that supports worker monitoring (3.4.0 runtime or later), you have the option to check *Automatically restart application when not responding*. With this box checked, CloudHub automatically restarts your application when the monitoring system discovers a problem with your application. If this box is not checked, CloudHub produces all the log messages, notifications, and any configured alerts, but takes no action to restart the application. 

Read more about worker monitoring.



== Configuring a Deployed Application

Most of the settings discussed in the steps above can be edited once the application is already deployed to CloudHub. To do so you must:

. In the Applications tab, select an application entry and click *Manage Application*:
+
image:AMC_ManageApplication.png[AMC_ManageApplication] 
+
. Click the *Settings* tab:
+
image:ViewingDeployedApp.png[ViewingDeployedApp]


== Deploy to CloudHub from Anypoint Studio

You can easily deploy your applications to CloudHub, straight from Anypoint Studio. This is specially helpful if you're still developing the application and want to deploy it often to an online test environment. To do this, left click on the application in the package explorer, *Deploy to Anypoint Platform*.

image:CHDeployToCH.png[CHDeployToCH]

If this is your first time deploying in this way, a popup menu asks you to provide your login credentials for the Anypoint Platform. Your credentials are then  stored and used automatically next time you deploy to Runtime Manager. You can manage these credentials through the Studio preferences menu, in *Anypoint Studio* > *Authentication*.

image:studio-to-cloudhub3.png[studio to cloudhub3]

Once you have signed in, the Deploy to CloudHub menu opens. Choose a unique domain to deploy the application to, the sub organization under which you deploy, an environment, and a Mule Version. You can also assign environment variables.

image:deploy-from-studio.jpg[deploy-from-studio]

== Automatically Deploying a Proxy from the Anypoint Platform for APIs

If you've registered an API in the Anypoint Platform, you can easily run it through an auto generated proxy to track its usage and implement policies. You can deploy this proxy to CloudHub without ever needing to go into the CloudHub section of the Anypoint platform. From a menu in the API version page, you can trigger the deployment of your proxy and set up the application name in CloudHub, the CloudHub environment and the Gateway version to use. Then, you can optionally access the CloudHub deployment menu for this proxy and configure advanced settings. See link:/anypoint-platform-for-apis/proxying-your-api[Proxying Your API].

== Deployment Errors

If an error occurs and the application cannot be deployed, the application status indicator changes to red. You are alerted in the status area that an error occurred. Check the log details for any application deployment errors. You need to correct the error, upload the application, and deploy again.

== See Also

* You can also deploy applications directly from link:/runtime-manager/hello-world-on-cloudhub[Anypoint Studio] or the link:/runtime-manager/command-line-tools[Command Line Tools]. A complete set of link:/runtime-manager/cloudhub-api[REST APIs] are also available for deployment.
* link:/runtime-manager/managing-cloudhub-applications[Managing CloudHub Applications] contains more information on how to manage your CloudHub application, make changes, scale workers, and perform other application management tasks.
